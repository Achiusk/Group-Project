<UserControl xmlns="https://github.com/avaloniaui"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
       xmlns:vm="using:urban_city_power_managment.ViewModels"
  mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700"
        x:Class="urban_city_power_managment.Views.GasInfrastructureView"
   x:DataType="vm:GasInfrastructureViewModel">

    <ScrollViewer>
 <StackPanel Spacing="24">
  <!-- Header -->
      <StackPanel Spacing="8">
          <TextBlock Text="{Binding Title}" Classes="header"/>
  <StackPanel Orientation="Horizontal" Spacing="16">
             <StackPanel Orientation="Horizontal" Spacing="8">
      <TextBlock Text="Status:" FontWeight="SemiBold"/>
            <TextBlock Text="{Binding OverallStatus}" FontWeight="Bold" Foreground="#01689B"/>
        </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="8">
    <TextBlock Text="{Binding ActiveAlertsLabel}:" FontWeight="SemiBold"/>
             <TextBlock Text="{Binding ActiveAlertsCount}" FontWeight="Bold" Foreground="#D32F2F"/>
         </StackPanel>
     </StackPanel>
      </StackPanel>

   <!-- Action Buttons -->
         <StackPanel Orientation="Horizontal" Spacing="12">
        <Button Click="OnRefreshDataClick" Classes="primary" Cursor="Hand">
  <TextBlock Text="Refresh Data" FontWeight="SemiBold"/>
 </Button>
          <Button Click="OnCheckForLeaksClick" Classes="secondary" Cursor="Hand">
  <TextBlock Text="Check for Leaks" FontWeight="SemiBold"/>
   </Button>
  </StackPanel>

  <!-- Total Gas Consumption -->
         <Border Classes="card" Background="#E3F2FD">
        <StackPanel Spacing="12">
      <TextBlock Text="{Binding TotalConsumptionLabel}" FontSize="18" FontWeight="SemiBold"/>
    <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
  <TextBlock Text="{Binding TotalGasConsumption, StringFormat='{}{0:N0}'}" 
            FontSize="32" 
  FontWeight="Bold" 
   Foreground="#01689B"/>
 <TextBlock Text="m³" FontSize="20" Foreground="#666" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
    </StackPanel>
    </StackPanel>
     </Border>

    <!-- Active Alerts Section -->
     <StackPanel Spacing="16" IsVisible="{Binding !!ActiveAlertsCount}">
      <TextBlock Text="{Binding ActiveAlertsLabel}" FontSize="20" FontWeight="SemiBold" Foreground="#D32F2F"/>
    
     <ItemsControl ItemsSource="{Binding ActiveAlerts}">
           <ItemsControl.ItemTemplate>
     <DataTemplate>
  <Border Classes="card" BorderBrush="#D32F2F" BorderThickness="2" Margin="0,0,0,12">
        <StackPanel Spacing="12">
        <Grid ColumnDefinitions="*,Auto">
       <StackPanel Grid.Column="0" Spacing="4">
      <TextBlock Text="{Binding Location}" FontSize="16" FontWeight="SemiBold"/>
     <TextBlock Text="{Binding Description}" TextWrapping="Wrap" Foreground="#666"/>
        </StackPanel>
           <StackPanel Grid.Column="1" Spacing="4" HorizontalAlignment="Right">
        <Border Background="#D32F2F" 
    CornerRadius="4" 
         Padding="8,4">
     <TextBlock Text="{Binding Severity}" 
           Foreground="White" 
      FontWeight="SemiBold" 
        FontSize="12"/>
     </Border>
          </StackPanel>
              </Grid>

        <Grid ColumnDefinitions="*,*,*" ColumnSpacing="16">
     <StackPanel Grid.Column="0" Spacing="4">
 <TextBlock Text="Pressure Drop" FontSize="12" Foreground="#666"/>
     <TextBlock FontWeight="SemiBold">
    <Run Text="{Binding PressureDrop, StringFormat='{}{0:F2}'}"/>
      <Run Text="bar"/>
        </TextBlock>
        </StackPanel>
      <StackPanel Grid.Column="1" Spacing="4">
       <TextBlock Text="Flow Anomaly" FontSize="12" Foreground="#666"/>
     <TextBlock FontWeight="SemiBold">
        <Run Text="{Binding FlowRateAnomaly, StringFormat='{}{0:F0}'}"/>
     <Run Text="m³/h"/>
        </TextBlock>
          </StackPanel>
   <StackPanel Grid.Column="2" Spacing="4">
   <TextBlock Text="Affected Customers" FontSize="12" Foreground="#666"/>
  <TextBlock Text="{Binding AffectedCustomers}" FontWeight="SemiBold"/>
     </StackPanel>
            </Grid>

        <StackPanel Orientation="Horizontal" Spacing="8">
       <TextBlock Text="Detected:" FontSize="12" Foreground="#666"/>
        <TextBlock Text="{Binding DetectedAt, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}" FontSize="12"/>
       </StackPanel>

         <Button Click="OnResolveAlertClick"
     CommandParameter="{Binding Id}"
   Classes="primary"
          Cursor="Hand">
     <TextBlock Text="Resolve Alert" FontWeight="SemiBold"/>
            </Button>
     </StackPanel>
                 </Border>
  </DataTemplate>
        </ItemsControl.ItemTemplate>
            </ItemsControl>
     </StackPanel>

            <!-- Gas Usage by Zone -->
   <StackPanel Spacing="16">
  <TextBlock Text="{Binding ZoneStatusLabel}" FontSize="20" FontWeight="SemiBold"/>
     
      <ItemsControl ItemsSource="{Binding GasUsageData}">
     <ItemsControl.ItemTemplate>
    <DataTemplate>
        <Border Classes="card" Margin="0,0,0,12">
        <StackPanel Spacing="12">
      <Grid ColumnDefinitions="*,Auto">
     <TextBlock Grid.Column="0" Text="{Binding Location}" FontSize="16" FontWeight="SemiBold"/>
    <Border Grid.Column="1" 
         Background="#4CAF50"
        CornerRadius="12" 
     Padding="8,4"
      IsVisible="{Binding IsNormal}">
           <TextBlock Text="Normal" 
          Foreground="White" 
   FontSize="12" 
    FontWeight="SemiBold"/>
    </Border>
     <Border Grid.Column="1" 
   Background="#D32F2F"
  CornerRadius="12" 
    Padding="8,4"
         IsVisible="{Binding !IsNormal}">
                 <TextBlock Text="Alert" 
            Foreground="White" 
   FontSize="12" 
    FontWeight="SemiBold"/>
        </Border>
            </Grid>

       <Grid ColumnDefinitions="*,*,*" ColumnSpacing="16">
            <StackPanel Grid.Column="0" Spacing="4">
         <TextBlock Text="Pressure" FontSize="12" Foreground="#666"/>
         <TextBlock FontWeight="SemiBold">
         <Run Text="{Binding Pressure, StringFormat='{}{0:F2}'}"/>
       <Run Text="bar"/>
</TextBlock>
    </StackPanel>
 <StackPanel Grid.Column="1" Spacing="4">
            <TextBlock Text="Flow Rate" FontSize="12" Foreground="#666"/>
         <TextBlock FontWeight="SemiBold">
        <Run Text="{Binding FlowRate, StringFormat='{}{0:F0}'}"/>
     <Run Text="m³/h"/>
    </TextBlock>
          </StackPanel>
            <StackPanel Grid.Column="2" Spacing="4">
    <TextBlock Text="Temperature" FontSize="12" Foreground="#666"/>
  <TextBlock FontWeight="SemiBold">
          <Run Text="{Binding Temperature, StringFormat='{}{0:F1}'}"/>
<Run Text="°C"/>
 </TextBlock>
         </StackPanel>
            </Grid>

       <StackPanel Spacing="4">
      <TextBlock Text="Total Consumption" FontSize="12" Foreground="#666"/>
              <TextBlock FontWeight="SemiBold">
 <Run Text="{Binding TotalConsumption, StringFormat='{}{0:N0}'}"/>
       <Run Text="m³"/>
    </TextBlock>
          </StackPanel>

                 <TextBlock Text="{Binding Timestamp, StringFormat='Last updated: {0:HH:mm:ss}'}" 
     FontSize="11" 
    Foreground="#999"/>
        </StackPanel>
     </Border>
         </DataTemplate>
           </ItemsControl.ItemTemplate>
   </ItemsControl>
    </StackPanel>
     </StackPanel>
    </ScrollViewer>
</UserControl>
